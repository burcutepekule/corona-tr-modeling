dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
t_lock      = 9;
shift_relax= -60;
m_relax    = 0.02;
t_normal   = 360;
r_end      = 0.3;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
times       =  seq(from=0,to=360,by=1) # returns a sequence
t_lock      = 9;
shift_relax= -60;
m_relax    = 0.02;
t_normal   = 360;
r_end      = 0.3;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
times       =  seq(from=0,to=180,by=1) # returns a sequence
t_lock      = 9;
shift_relax= -60;
m_relax    = 0.02;
t_normal   = 360;
r_end      = 0.3;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
times       =  seq(from=0,to=240,by=1) # returns a sequence
t_lock      = 9;
shift_relax= -60;
m_relax    = 0.02;
t_normal   = 360;
r_end      = 0.3;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
times       =  seq(from=0,to=120,by=1) # returns a sequence
t_lock      = 9;
shift_relax= -60;
m_relax    = 0.02;
t_normal   = 360;
r_end      = 0.3;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
shift_relax= -240;
m_relax    = 0.1;
r_end      = 0.3;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
r_end      = 0.5;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
shift_relax= -240;
m_relax    = 0.1;
r_end      = 0.35;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
r_end      = 0.25;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
times       =  seq(from=0,to=180,by=1) # returns a sequence
t_lock      = 9;
t_normal   = 360;
shift_relax= -240;
m_relax    = 0.1;
r_end      = 0.25;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
shift_relax= -180;
m_relax    = 0.05;
r_end      = 0.25;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
shift_relax= -210;
m_relax    = 0.05;
r_end      = 0.25;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
shift_relax= -200;
m_relax    = 0.05;
r_end      = 0.25;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
times       =  seq(from=0,to=240,by=1) # returns a sequence
t_lock      = 9;
t_normal   = 360;
shift_relax= -200;
m_relax    = 0.05;
r_end      = 0.25;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
times       =  seq(from=0,to=180,by=1) # returns a sequence
t_lock      = 9;
t_normal   = 360;
shift_relax= -200;
m_relax    = 0.05;
r_end      = 0.25;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
# pessimistic
shift_relax= -240;
m_relax    = 0.1;
r_end      = 0.28;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
# pessimistic
shift_relax= -240;
m_relax    = 0.1;
r_end      = 0.25;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out[,2:9] = popsize*out[,2:9];
dC = c(0,diff(out$C));
dX = c(0,diff(out$X));
out = tibble(out,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out,type='l',main="ICU",col="pink")
points(icu_data)
# optimistic
shift_relax= -200;
m_relax    = 0.05;
r_end      = 0.25;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out_o <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out_o[,2:9] = popsize*out_o[,2:9];
dC    = c(0,diff(out_o$C));
dX    = c(0,diff(out_o$X));
out_o = tibble(out_o,dC,dX)
# pessimistic
shift_relax= -240;
m_relax    = 0.1;
r_end      = 0.25;
params_b = c(t_lock,shift_relax,m_relax,t_normal,r_end)
params   = c(params_a,params_b,K,mu,sig)
out_p <- as.data.frame(
ode(
func=covid.model,
y=ystart,
times=times,
parms=params
)
)
out_p[,2:9] = popsize*out_p[,2:9];
dC    = c(0,diff(out_p$C));
dX    = c(0,diff(out_p$X));
out_p = tibble(out_p,dC,dX)
par(mfrow=c(2,2))
plot(dC~time,data=out_o,type='l',main="C",col="blue")
plot(dC~time,data=out_p,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out_o,type='l',main="X",col="red")
plot(dX~time,data=out_p,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out_o,type='l',main="ICU",col="pink")
plot(ICU~time,data=out_p,type='l',main="ICU",col="pink")
points(icu_data)
par(mfrow=c(2,2))
plot(dC~time,data=out_o,type='l',main="C",col="blue")
line(dC~time,data=out_p,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out_o,type='l',main="X",col="red")
line(dX~time,data=out_p,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out_o,type='l',main="ICU",col="pink")
line(ICU~time,data=out_p,type='l',main="ICU",col="pink")
points(icu_data)
par(mfrow=c(2,2))
plot(dC~time,data=out_o,type='l',main="C",col="blue")
lines(dC~time,data=out_p,type='l',main="C",col="blue")
points(daily_cases_data)
plot(dX~time,data=out_o,type='l',main="X",col="red")
lines(dX~time,data=out_p,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out_o,type='l',main="ICU",col="pink")
lines(ICU~time,data=out_p,type='l',main="ICU",col="pink")
points(icu_data)
par(mfrow=c(2,2))
plot(dC~time,data=out_o,type='l',main="C",col="blue")
lines(dC~time,data=out_p,type='l',main="C",col="blue")
grid(nx = NULL, ny = nx, col = "lightgray", lty = "dotted")
points(daily_cases_data)
plot(dX~time,data=out_o,type='l',main="X",col="red")
lines(dX~time,data=out_p,type='l',main="X",col="red")
points(daily_deaths_data)
plot(ICU~time,data=out_o,type='l',main="ICU",col="pink")
lines(ICU~time,data=out_p,type='l',main="ICU",col="pink")
points(icu_data)
